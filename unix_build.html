<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Description" content="Description" content="Machine Learning, AI, Data Science, Python, Jupyter, Linux, Cloud, SQL">
   <meta name="GENERATOR" content="Mozilla/4.7 [en] (WinNT; U) [Netscape]">
   <meta name="Author" content="Lev Selector">
   <title>Building Packages</title>
<!--

"Description" content="Machine Learning, AI, Data Science, Python, Jupyter, Linux, Cloud, SQL"

-->
<link REL="stylesheet" TYPE="text/css" HREF="style0.css" >
<style type="text/css">
<!--
.style1 {
	color: #CC0000;
	font-weight: bold;
}
.code {color: #0000FF}
.comment {color: #669900}
-->
</style>
</head>
<body text="#000000" bgcolor="#FFFFFF">
<a NAME="top"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b><font color="#CC0000">LevSelector.com</font></b><spacer type=block width=1 height=1></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><spacer type=block width=1 height=1><b><font color="#CC0000">New
York</font></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<tr>
<td><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td BGCOLOR="#66CCFF"><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td><spacer type=block width=1 height=1></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><spacer type=block width=1 height=1>
<b><a href="index.html">home</a>
> Building Projects on Unix</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><spacer type=block width=1 height=1><b></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<tr>
<td><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td BGCOLOR="#51C7FF"><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td><spacer type=block width=1 height=1></td>
</tr>
</table>

<p><b><font color="#CC0000">Building Projects on Unix</font></b> (page under construction - still you may find it very useful)
<table width="95%" border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td><span class="style1">On This Page</span></td>
    <td class="style1">Other Pages</td>
  </tr>
  <tr>
    <td valign="top">
    <p>
- <a href="#intro">intro</a><br>
- <a href="#gcc_usage">gcc usage</a><br>
- <a href="#search_paths">search paths</a><br>
- <a href="#environment">environment</a><br>
- <a href="#linking">linking</a><br>
    </p>    </td>
    <td valign="top">
    <p>
- <a href="unix_make.html">gmake</a><a href="#xx"></a><br>
<br>
    </p>    </td>
  </tr>
</table>
<p class="sectionheader"><a NAME="intro"></a>Intro ------------------------------</p>
  <p>Building here is a process of preprocessing, compiling, assemblying and linking.</p>
  <p>Big software project may depend on hundreds of source files and libraries. Many developers can work in parallel on different pieces of it. Then all these pieces are combined together during the build process. The GNU project provides a set of standard tools which allows to write/build software to run on different unix-s. It also makes the build process simplier (standard steps: configure,  make build, make test, make install). Here are some standard tools/files:</p>
  <ul>
    <li><a href="http://gcc.gnu.org/"><strong>gcc</strong></a> - gnu compiler collection
      <ul>
        <li><span class="style1">gcc</span> (= <span class="style1">cc</span>) - C-compiler</li>
        <li><span class="style1">g++</span> (= <span class="style1">c++</span>) - C++ compiler</li>
        <li><span class="style1">cc1</span>, <span class="style1">cc1plus</span> - C/C++ compilers (part of GCC, under /usr/libexec/gcc/i386-redhat-linux/3.4.6/ or similar directory)</li>
        <li><span class="style1">cpp</span> - preprocessor </li>
        <li><span class="style1">as</span> -  assembler (produces binary code from assembly language code and puts it in an object file *.o).</li>
        <li><span class="style1">ld</span> - linker -  produces an executable binary file from object files and libraries</li>
        <li>etc. etc.</li>
      </ul>
    </li>
    <li><span class="style1">configure</span> - a long executable shell script (usually generated by auto-tools listed below) which in many cases you run as a first step of the build. It generates a custom Makefile to fit the system it is being compiled on.</li>
    <li><a href="http://directory.fsf.org/GNU/make.html"><strong>gmake</strong></a> - a utility to execute the Makefile. See brief tutorial here: <a href="unix_make.html">unix_make.html</a></li>
    <li><a href="http://www.gnu.org/software/autoconf/"><strong>autoconf</strong></a> - utility to create a configure script. Accepts configure.in or configure.ac.
      <ul>
        <li><span class="style1">autoheader</span> - tool to help manage  C header files</li>
        <li> <span class="style1">autoscan</span> - tool to  create an initial input file for autoconf</li>
        <li> <span class="style1">ifnames</span> - tool to create a list of C pre-processor identifiers used in the program</li>
      </ul>
    </li>
    <li><a href="http://www.gnu.org/software/automake/"><strong>automake</strong></a> - to create portable Makefiles (takes its input as Makefile.am, and turns it into Makefile.in, which is used by the configure script to generate the file Makefile output).</li>
    <li><a href="http://www.gnu.org/software/libtool/"><strong>libtool</strong></a> - tool to manage the creation of static and dynamic libraries on various flavors of unix (Linux, Solaris, etc.).</li>
    <li><span class="style1">gnulib</span> - simplifies the process of making software that uses <span class="style1">autoconf</span> and <span class="style1">automake</span> portable to a wide range of systems.</li>
    <li><span class="style1">ar</span> - archiver - creates an *.a file by archiving several .o files into it: ar rcs libclass.a class1.o class2.o class3.o<br>
Note - there are several formats of .a files, the most common are GNU and BSD - see <a href="http://en.wikipedia.org/wiki/Ar_(Unix)">http://en.wikipedia.org/wiki/Ar_(Unix)</a></li>
    <li><span class="style1">gettext</span> - translate a text string into the user&rsquo;s native language</li>
    <li><span class="style1">pkg-config</span> - retrieve information about installed libraries in the system</li>
    <li><span class="style1">autoreconf</span> - Update generated configuration files</li>
    <li><span class="style1">ldd</span> - print shared library dependencies (ldd /bin/time; ldd `which xterm`; ...)</li>
    <li><span class="style1">nm</span> - lists the symbols from object files</li>
    <li><strong><a href="http://www.gnu.org/software/binutils/">binutils</a></strong> - <span class="red">ld, as, ar, nm, strings, strip, gprof, c++filt, etc.</span></li>
    <li><a href="http://www.gnu.org/software/gdb/"><strong>gdb</strong></a> - GNU debugger</li>
    <li><a href="http://www.gnu.org/software/ncurses/ncurses.html"><strong>ncurses</strong></a> - <br>
    </li>
  </ul>
<p>For C and C++ projects, the common file type are:</p>
  <ul>
    <li>.c, .cc - source C or C++ files</li>
    <li>.i, .ii - preprocessed source (generated by gcc or g++)</li>
    <li>.s - assembly language source (assembled by &quot;as&quot;)</li>
    <li>.o - compiled object files (modules) ready for linking</li>
    <li>.a - library of object modules (ar arname member1 member 2 ...)</li>
    <li>.so - shared (dynamically loaded) libraries (.dylib on Mac X).<br>
      <a href="http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html</a></li>
    <li>.lo, .la - library files created by libtool. </li>
  </ul>
  <p>Note: on Windows you can use Cygwin (or MSYS) to emulate unix build environment.</p>
  <p>Note: The user working on a project can generate the  ./configure file by running shell script (autogen.sh) which would run a series of commands -  something like this: aclocal; autoconf; autoheader; automake<br>
  </p>
  <p class="sectionheader"><a name="gcc_usage"></a> gcc usage --------------------</p>
<p><span class="code">cc -E hello.c; 
view hello.i</span> - does only preprocessing and shows the result<br>
<span class="code">cc -S hello.c ; 
view hello.s</span> - generates assembler code<br>
<span class="code">cc -g -c hello.s; 
view hello.o</span> - generates object code <br>
<span class="code">dis -L -t .data hello.o &gt;hello.dis</span> - disassemble the object file into a text file<br>
<span class="code">cc -o hello hello.c</span> - does all steps (pre-processing, compiling, assembling, linking) - and generates output executable &quot;hello&quot;</p>
<p>Here are some common compiler options:</p>
<table border="0" cellpadding="3" cellspacing="0" bgcolor="#FFFFCC">
  <tr>
    <td> -c - compile only (do not link) <br>
-S - stop after making assempler code <br>
-E - stop after preprocessing stage <br>
-o file - define the output file <br>
-v - verbouse (print commands executed on STDERR, also print compiler version, etc.) <br>
-l - to specify libraries to link ( -lxyz means to link libxyz.a)<br>
-L - to specify directories to search for libraries <br>
-I - to specify directories to search for include files <br>
-B/some/path - prefix to find  executables,           libraries, include files, and data files of the compiler           itself. Default is /usr/lib/gcc/, /usr/local/lib/gcc-lib/, and $PATH<br>
-static - tells compiler to include shared libraries into the executable (thus making it larger) - even though the libraries are available (usually in /lib) and can be linked dynamically during execution (on systems that support dynamic linking) <br>
-shared - produce a shared object which can then be linked with other objects  to  form an executable.  Only a few systems support this option. <br>
-symbolic - bind  references to global symbols when building a shared object, warn about any unresolved references - only if supported. <br>
-On, where n=0,1,2,or 3 - sets level of optimization <br>
-b machine - to specify the type of machine for which to compile <br>
-V version - to specify which version of compiler to run<br>
-g  Produce debugging information in the operating system's native format<br>
there are many more options (100s) - see man pages for the compiler.</td>
  </tr>
</table>
<p class="sectionheader"><a name="search_paths"></a>Search Paths --------------------</p>
<p>To see gcc default search paths run <span class="style1">gcc -print-search-dirs</span>. It will show where gcc is installed, and list of directories where it looks for its binaries or libraries. The search path for headers is different than that for libraries. For headers gcc will look into &quot;include&quot; subdirectories, for example:</p>
<p><span class="code">/usr/include/</span><br>
<span class="code">/usr/include/c++/</span> - for C++</p>
<p>On normal Unix system gcc will look for header files  in  directories similar to these:</p>
<p class="code"> /usr/local/include/<br>
  /usr/libexec/gcc/sometarget/someversion/include/<br>
  /usr/lib/gcc/sometarget/someversion/include/<br>
  /usr/sometarget/include/<br>
  /usr/include/</p>
<p>(where, for example, <span class="code">sometarget/someversion = i386-redhat-linux/3.4.6</span>)</p>
<p>The search for libraries themselves may be like this:</p>
<p><span class="code">/usr/lib/gcc/sometarget/someversion/<br>
/usr/sometarget/lib/sometarget/someversion/<br>
/usr/sometarget/lib/<br>
/usr/lib/sometarget/someversion/<br>
/usr/lib/<br>
/lib/sometarget/someversion/<br>
/lib/</span></p>
<p>Note: main library for C is <span class="style1">libc.a</span>, for C++ -  <span class="style1">libstdc++.a</span></p>
<p>Note: you an use the following gcc options:</p>
<ul>
  <li> <span class="style1">-I</span> - to specify directories to search for include files</li>
  <li><span class="style1">-L</span> - to specify directories to search for libraries</li>
  <li><span class="style1">-nostdinc</span> option - to prevent GCC from searching any of the default directories</li>
</ul>
<p>Read more details here: <a href="http://gcc.gnu.org/onlinedocs/gcc-4.3.0//cpp/Search-Path.html#Search-Path">http://gcc.gnu.org/onlinedocs/gcc-4.3.0//cpp/Search-Path.html#Search-Path</a></p>
<p>Note: you can use GCC with a number of different C libraries. Here are some examples:</p>
<ul>
  <li><a href="http://www.gnu.org/software/libc/">http://www.gnu.org/software/libc/</a></li>
  <li><a href="http://www.fefe.de/dietlibc/">http://www.fefe.de/dietlibc/</a></li>
  <li><a href="http://sources.redhat.com/newlib/">http://sources.redhat.com/newlib/</a></li>
  <li><a href="http://www.uclibc.org">http://www.uclibc.org</a> (<a href="http://www.buildroot.org">http://www.buildroot.org</a>)</li>
</ul>
<p class="sectionheader"><a name="environment"></a>Environment --------------------</p>
<p>GCC_INCLUDE_DIR, LD_LIBRARY_PATH, LD_PRELOAD, etc.</p>
<p>David Barr &quot;Why LD_LIBRARY_PATH is bad&quot;:<br>
&nbsp;&nbsp; <a href="http://xahlee.org/UnixResource_dir/_/ldpath.html" eudora="autourl">http://xahlee.org/UnixResource_dir/_/ldpath.html</a></p>
<p>&quot;LD_LIBRARY_PATH is one of those insidious things that once it gets set globally for a user, things tend to happen which cause people to rely on it being set. Eventually when LD_LIBRARY_PATH needs to be changed or removed, mass breakage will occur!&quot;</p>
<p class="sectionheader"><a name="linking"></a>Linking --------------------</p>
<p>Static linking - include libraries into the executable itself. Advantage - no dependencies on external libraries. Disadvantage - executable gets larger, all utilities/extensions will be also larger. </p>
<p>Dynamic linking - using external shared libraries. This is the default linking option. Advantage - smaller executables. Disadvantage - we need to make sure that executable will find the libraries and that these libraries has the right version to match the executables.</p>
<p>The search for shared libraries can be influenced by a number of factors:</p>
<ul>
  <li>How the executable was linked and with which options</li>
  <li>setguid or setuid?</li>
  <li>permissions?</li>
  <li>bitness (32 or 64 bit)</li>
  <li>etc.</li>
</ul>
<p>/lib/ld.so - shared library loader</p>
<p>&nbsp;</p>
</body>
</html>
