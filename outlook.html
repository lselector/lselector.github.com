<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Description" content="Machine Learning, AI, Data Science, Python, Jupyter, Linux, Cloud, SQL">
   <meta name="GENERATOR" content="Mozilla/4.7 [en] (WinNT; U) [Netscape]">
   <meta name="Author" content="ls">
   <title>outlook</title>
<!--

"Description" content="Machine Learning, AI, Data Science, Python, Jupyter, Linux, Cloud, SQL"

-->
<link rel="stylesheet" type="text/css" href="style0.css">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<a NAME="top"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>

<td ALIGN=LEFT><b><font color="#CC0000">oedocs</font></b><spacer type="block" width="1" height="1"></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><spacer type="block" width="1" height="1"><b><font color="#CC0000">GS,
NY</font></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td><spacer type="block" width="1" height="1"></td>
</tr>

<tr>
<td BGCOLOR="#66CCFF"><spacer type="block" width="1" height="1"></td>
</tr>

<tr>
<td><spacer type="block" width="1" height="1"></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>

<td ALIGN=LEFT><spacer type="block" width="1" height="1"><b><a href="index.html">home</a>
> <font color="#000000">Outlook &amp; Exchange - programming</font></b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><spacer type="block" width="1" height="1"><b><a href="mailto:Lev.Selector@gmail.com">Email</a></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td><spacer type="block" width="1" height="1"></td>
</tr>

<tr>
<td BGCOLOR="#51C7FF"><spacer type="block" width="1" height="1"></td>
</tr>

<tr>
<td><spacer type="block" width="1" height="1"></td>
</tr>
</table>

<p><b><font color="#CC0000">Outlook &amp; Exchange - programming</font></b>
<p><font color="#6699CC">• </font><a href="#intro">intro</a>
<br><font color="#6699CC">• </font><a href="#codes1">codes1</a>
<p><a NAME="intro"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>

<td ALIGN=LEFT><b>intro</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - <a href="mailto:Lev.Selector@gmail.com">email</a></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>
</tr>
</table>

<p>- <a href="http://www.cdolive.com/code.htm">http://www.cdolive.com/code.htm</a>
- CDO Live - Code Sample Library (<a href="http://www.cdolive.com/mbxreport.htm">
http://www.cdolive.com/mbxreport.htm</a> )
<br>- <a href="http://msdn.microsoft.com/library/default.asp?URL=/library/techart/outlookanchor.htm">http://msdn.microsoft.com/library/default.asp?URL=/library/techart/outlookanchor.htm</a>
- Outlook Technical articles
<br>- <a href="http://search.support.microsoft.com/kb/c.asp">http://search.support.microsoft.com/kb/c.asp</a>
- Microsoft Knowledge Base
<br>- <a href="http://support.microsoft.com/support">http://support.microsoft.com/support</a>
- Microsoft Support Web site
<br>- <a href="http://www.microsoft.com/office/developer">http://www.microsoft.com/office/developer</a>
- Microsoft Office Developer Support Web site
<br>- <a href="http://msdn.microsoft.com">http://msdn.microsoft.com</a>
- Microsoft Developer Network
<br>- <a href="http://mspress.microsoft.com">http://mspress.microsoft.com</a>
- Microsoft Press
<br>- <a href="http://support.microsoft.com/support/news">http://support.microsoft.com/support/news</a>
- Public Internet newsgroups
<br>- <a href="http://www.ilx.com">http://exchange.devx.com/</a> - Exchange
&amp; Outlook magazine
<p><a NAME="codes1"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>

<td ALIGN=LEFT><b>codes1</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - <a href="mailto:Lev.Selector@gmail.com">email</a></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type="block" width="1" height="1"></td>
</tr>
</table>

<p><b><u>Getting information from Contacts folder localy:</u></b>
<table BORDER=0 CELLSPACING=0 CELLPADDING=2 BGCOLOR="#CCFFFF" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td>use strict;&nbsp;
<br>use Win32::OLE;&nbsp;
<br>use Win32::OLE::Const 'Microsoft Outlook';&nbsp;
<br><font color="#009900"># or 'Microsoft Outlook 9.0 Object Library';</font>
<br><font color="#009900"># Const module defines many usefule constants
- like </font><font color="#990000">olFolderContacts</font><font color="#009900">
, etc.</font>
<p>my $Outlook = Win32::OLE-><b>GetActiveObject</b>('<font color="#CC0000">
Outlook.Application</font>') or die "oops 1";&nbsp;
<br>my $namespace = $Outlook-><b>GetNamespace</b>("<font color="#CC0000">
MAPI</font> ");&nbsp;
<br>my $Folder = $namespace-><b>GetDefaultFolder</b>(<font color="#CC0000">
olFolderContacts</font>) or die "oops 2";&nbsp;
<p><font color="#009900">#&nbsp; my $NewFolder = $Folder->Folders->Add("test_folder");</font>
<p>my $contacts = $Folder->{<font color="#CC0000">Items</font>};&nbsp;
<br>my $ncon = $contacts->{<font color="#CC0000">Count</font>};&nbsp;
<br>&nbsp; print "number of contacts - $ncon\n\n"; # this works&nbsp;
<p>#&nbsp; print '-'x50,"\n";&nbsp;
<br>#&nbsp; map {print "$_\n" } keys %{$contacts-><b>Item</b>(1)};&nbsp;
<br>#&nbsp; print '-'x50,"\n";&nbsp;
<p>my $con&nbsp;
<br>for my $ii (1 .. $ncon) {&nbsp;
<br>&nbsp; $con = $contacts-><b>Item</b>($ii);&nbsp;
<br>&nbsp; print "$ii - $con->{FullName}\n";&nbsp;
<br>}&nbsp;
<p><font color="#3333FF">print "\nAnother way to iterate\n\n";</font>
<p>$con=$contacts-><b>GetFirst</b>();&nbsp;&nbsp;&nbsp; print "$con->{FullName}\n";&nbsp;
<br>while ($con=$contacts-><b>GetNext</b>()) {&nbsp; print "$con->{FullName}\n";&nbsp;
}</td>
</tr>
</table>

<p><b><u>List Address Lists available in your Outlook:</u></b>
<table BORDER=0 CELLSPACING=0 CELLPADDING=2 BGCOLOR="#CCFFFF" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td>use strict;&nbsp;
<br>use Win32::OLE;&nbsp;
<br>use Win32::OLE::Const 'Microsoft Outlook';&nbsp;
<p>my $Outlook = Win32::OLE->GetActiveObject('Outlook.Application')&nbsp;
<br>&nbsp; or die "oops GetActiveObject\n";&nbsp;
<br>&nbsp;&nbsp; <font color="#009900"># $Outlook = Win32::OLE->new('Outlook.Application',
'Quit');</font>
<p>my $namespace = $Outlook->GetNamespace("MAPI");&nbsp;
<br>my $addrlists = $namespace->{AddressLists}&nbsp;
<br>&nbsp; or die "oops AddressLists\n";&nbsp;
<br>my $alcount = $addrlists->{Count};&nbsp;
<br>for my $ii (1..$alcount) {&nbsp;
<br>&nbsp; my $Item = $addrlists->Item($ii);&nbsp;
<br>&nbsp; my $name = $Item->{Name};&nbsp;
<p>&nbsp; print "$ii = $name\n";&nbsp;
<br>}</td>
</tr>
</table>

<p><b><u>print information about members of a mailing list:</u></b>
<table BORDER=0 CELLSPACING=0 CELLPADDING=2 BGCOLOR="#CCFFFF" >
<caption><tbody>
<br></tbody></caption>

<tr>
<td>use strict;&nbsp;
<br>use Win32::OLE;&nbsp;
<br>use Win32::OLE::Const 'Microsoft Outlook';&nbsp;
<p>my $Outlook = Win32::OLE->GetActiveObject('<font color="#CC0000"> Outlook.Application</font>')&nbsp;
<br>&nbsp; or die "oops GetActiveObject\n";&nbsp;
<br>my $namespace = $Outlook->GetNamespace("<font color="#CC0000">MAPI</font>
");&nbsp;
<br>my $gal = $namespace->AddressLists("<font color="#CC0000">Global Address
List</font>");&nbsp;
<br>my $addr = $gal->AddressEntries("<font color="#CC0000">some-list</font>
");&nbsp;
<br>my $members = $addr->{Members};&nbsp;
<br>for my $ii (1 .. $members->{Count}) {&nbsp;
<br>&nbsp; my $rh = $members->Item($ii);&nbsp;
<br>&nbsp; my $name_ = $rh->{Name};&nbsp;
<br>&nbsp; my $id_&nbsp;&nbsp; = $rh->{ID};&nbsp;
<br>&nbsp; print "$name_\n&nbsp; $id_\n";&nbsp;
<br>}</td>
</tr>
</table>

<p><b><u>Use CDO to connect to Exchange</u></b>
<br><b><u>and get the number of contacts</u></b>
<br><b><u>from other people's folders:</u></b>
<table BORDER=0 CELLSPACING=0 CELLPADDING=2 BGCOLOR="#CCFFFF" >
<tr>
<td>use strict;&nbsp;
<br>use Win32::OLE;&nbsp;
<br>use Win32::OLE::Variant;&nbsp;
<br>use Win32::OLE::Const;&nbsp;
<p>my $DEBUG_FLAG = 1; # set it to zero for real job&nbsp;
<br>my $mailing_list_name = "some-list";&nbsp; # set it to real name&nbsp;
<br>my $server = "abcde01";
<br>my $fname = "john";
<br>my $lname = "smith";
<br>&nbsp;
<p># Necessary for MAPI component&nbsp;
<br>Win32::OLE->Initialize(Win32::OLE::COINIT_OLEINITIALIZE);&nbsp;
<p># Do this rather than 'use' as that interferes with the OLE Initialize
code&nbsp;
<br>my $CDO_CONST = Win32::OLE::Const->Load('Microsoft CDO.*Library');&nbsp;
<p>my $MAPI = Win32::OLE->new('MAPI.Session');&nbsp;
<br>die "Could instantiate MAPI Session: " . Win32::OLE::LastError() if
(! defined($MAPI));&nbsp;
<p>my %LogonParms = ( 'ProfileInfo' => "$server\n$fname.$lname" );&nbsp;
<p>$MAPI->logon(\%LogonParms);&nbsp;
<br>die Win32::OLE::LastError() if (Win32::OLE::LastError());&nbsp;
<br>print $MAPI->{CurrentUser}->Value . "\n";&nbsp;
<br>my $GAL = $MAPI->AddressLists("Global Address List")->{AddressEntries};&nbsp;
<p>my $Filter = $GAL->Filter();&nbsp;
<p>$Filter->{Name} = $mailing_list_name;&nbsp; # "gs-emaildev";&nbsp;
<p>my $DL = $GAL->GetFirst(); # Assumes unique match to above filter&nbsp;
<br>my $Members = $DL->{Members};&nbsp;
<p>for ( my $Member = $Members->GetFirst();&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Member != undef;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $Member = $Members->GetNext() ) {&nbsp;
<br>&nbsp; my $name = $Member->{DisplayName};&nbsp;
<br>&nbsp; print "Processing $name\n";&nbsp;
<br>&nbsp; if ($DEBUG_FLAG &amp;&amp; $name !~ /$lname/i) {&nbsp;
<br>&nbsp;&nbsp;&nbsp; print "debug - no access\n"&nbsp;
<br>&nbsp; } else {&nbsp;
<br>&nbsp;&nbsp;&nbsp; ProcessMbx($Member->Fields($$CDO_CONST{CdoPR_ACCOUNT})->Value);&nbsp;
<br>&nbsp; }&nbsp;
<br>}&nbsp;
<p>exit;&nbsp;
<br># ------------------------------------------------------------&nbsp;
<br># end of the main part&nbsp;
<br># ------------------------------------------------------------&nbsp;
<br>&nbsp;
<p># ------------------------------------------------------------&nbsp;
<br># ------------------------------------------------------------&nbsp;
<br>sub ProcessMbx {&nbsp;
<br>&nbsp;&nbsp;&nbsp; my $Account = shift;&nbsp;
<p>&nbsp;&nbsp;&nbsp; my $MAPI = Win32::OLE->new('MAPI.Session');&nbsp;
<br>&nbsp;&nbsp;&nbsp; die "Could instantiate MAPI Session: " . Win32::OLE::LastError()&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (! defined($MAPI));&nbsp;
<p>&nbsp;&nbsp;&nbsp; my %LogonParms = ( 'ProfileInfo' => "gsnb01e\n$Account"
);&nbsp;
<br>&nbsp;&nbsp;&nbsp; $MAPI->logon(\%LogonParms);&nbsp;
<br>&nbsp;&nbsp;&nbsp; die Win32::OLE::LastError() if (Win32::OLE::LastError());&nbsp;
<p>&nbsp;&nbsp;&nbsp; my $Contacts = $MAPI->GetFolder(&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $MAPI->{Inbox}->{Fields}->Item(0x36D10102),&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $MAPI->{Inbox}->{StoreID} );&nbsp;
<br>&nbsp;&nbsp;&nbsp; my $Items = $Contacts->{'Messages'};&nbsp;
<br>&nbsp;&nbsp;&nbsp; print "\tContacts - " . $Items->{'Count'} . "\n";&nbsp;
<br>}</td>
</tr>
</table>

<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=3 BGCOLOR="#CCFFFF" >
<tr>
<td>use strict;
<br>use Win32::OLE;
<br>use Win32::OLE::Const 'Microsoft Outlook';
<br>use Win32::OLE::Variant;
<p>my $Outlook = Win32::OLE->new('Outlook.Application', 'Quit');
<br>my $ol = Win32::OLE::Const->Load($Outlook);
<br>my $namespace = $Outlook->GetNamespace("MAPI");
<br>my $Folder = $namespace->GetDefaultFolder(olFolderContacts);
<p><font color="#009900">#&nbsp; my $NewFolder = $Folder->Folders->Add("test_folder");</font>
<p>my $contacts = $Folder->{Items};
<br>my $ncon = $contacts->{Count};
<br>print "number of contacts - $ncon\n\n"; # this works
<p>my $con;
<br>for my $ii (1 .. $ncon) {
<br>&nbsp; $con = $contacts->Item($ii);
<br>&nbsp; print "$ii - $con->{FullName}\n";
<br>&nbsp; print "Phone is $con->{HomeTelephoneNumber}\n";
<br>&nbsp; my $x = $$con{LastModificationTime};
<br>&nbsp; print "==2==&nbsp; ", $x,"\n",
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "--2-- " , $x->Date('dddd
MMM dd, yyyy') , ' '
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
, $x->Time('hh:mm:ss tt') , "\n";
<br>}
<p>__END__
<br>Z:\AAA_work\myperl>test.pl
<br>number of contacts - 2
<br>&nbsp;
<p>1 - TestContact1
<br>Phone is
<br>==2==&nbsp; 12/18/01 4:25:05 PM
<br>--2-- Tuesday Dec 18, 2001 04:25:05 PM
<br>2 - TestContact2
<br>Phone is
<br>==2==&nbsp; 10/1/01 12:04:40 PM
<br>--2-- Monday Oct 01, 2001 12:04:40 PM</td>
</tr>
</table>

<br>&nbsp;
</body>
</html>
