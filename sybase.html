<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Description" content="Machine Learning, AI, Data Science, Python, Jupyter, Linux, Cloud, SQL">
   <meta name="GENERATOR" content="Mozilla/4.79 [en] (X11; U; Linux 2.4.18-4GB i686) [Netscape]">
   <meta name="Author" content="Lev Selector">
   <title>sybase</title>
<!--

"Description" content="Machine Learning, AI, Data Science, Python, Jupyter, Linux, Cloud, SQL"

-->
<link REL="stylesheet" TYPE="text/css" HREF="style0.css" >
</head>
<body text="#000000" bgcolor="#FFFFFF">
<a NAME="top"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b><font color="#CC0000">LevSelector.com</font></b><spacer type=block width=1 height=1></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><spacer type=block width=1 height=1><b><font color="#CC0000">New
York</font></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<tr>
<td><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td BGCOLOR="#66CCFF"><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td><spacer type=block width=1 height=1></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><spacer type=block width=1 height=1><b><a href="index.html">home</a>
> Sybase</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><spacer type=block width=1 height=1><b></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" >
<tr>
<td><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td BGCOLOR="#51C7FF"><spacer type=block width=1 height=1></td>
</tr>

<tr>
<td><spacer type=block width=1 height=1></td>
</tr>
</table>

<p><b><font color="#CC0000">Sybase</font></b>
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=6 >
<tr>
<td><b><u><font color="#CC0000">On this page:</font></u></b></td>

<td><b><u><font color="#CC0000">Other pages:</font></u></b></td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP><font color="#6699CC">* </font><a href="#links">links</a>
<br><font color="#6699CC">* </font><a href="#tools">tools</a>
<br><font color="#6699CC">* </font><a href="#books">books</a>
<br><font color="#6699CC">* </font><a href="#hints">hints</a>
<br><font color="#6699CC">* </font><a href="#bcp">bcp</a>
<br><font color="#6699CC">* </font><a href="#results_into_excel">results
into excel</a></td>

<td ALIGN=LEFT VALIGN=TOP><font color="#6699CC">* </font><b><a href="sql_sybase.html">sql_sybase</a></b>
<br><font color="#6699CC">* <a href="sybase_isql.html">isql</a></font>
<br><font color="#6699CC">* <a href="sample_dblib_cgi.txt">sample_dblib.cgi</a></font>
<br>
<font color="#6699CC">* <a href="sample_dblib_pl.txt">sample_dblib.pl</a></font>
<br>
<font color="#6699CC">* <a href="perl_examples_1.html#dbi_sybase">sample
using dbi</a></font></td>
</tr>
</table>
<a NAME="links"></a>
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b>Links</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - </b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<p><font color="#6699CC">* </font><a href="http://directory.google.com/Top/Computers/Software/Databases/Sybase/">directory.google.com/Top/Computers/Software/Databases/Sybase/</a>
- on Google
<br><font color="#6699CC">* </font><a href="http://www.webcom.com/raberd/db2info.html">www.sybase.com</a>
- Sybase, Inc. - Main site for Sybase SQL Server
<br><font color="#6699CC">* </font><a href="http://www.sybase.com/support/manuals/">www.sybase.com/support/manuals/</a>
- Sybase online documentation (sybooks).&nbsp; (<a href="http://sybooks.sybase.com/as.html">ASE</a>,
<a href="http://sybooks.sybase.com/mx.html">AS-IQ-M</a>)
<br>(also
<a href="http://sybooks.sybase.com/">http://sybooks.sybase.com/</a>-
manuals ) -
<br><font color="#6699CC">* </font><a href="http://manuals.sybase.com/onlinebooks/group-as/srv10024/quickref">http://manuals.sybase.com/onlinebooks/group-as/srv10024/quickref</a>
- quick reference
<br><font color="#6699CC">* </font><a href="http://www.ncst.ernet.in/dbois/quickref/">http://www.ncst.ernet.in/dbois/quickref/</a>-
quick reference
<p><font color="#6699CC">* </font><a href="http://www.sybase.com/products/databaseservers/ase/">www.sybase.com/products/databaseservers/ase/</a>
- <b><font color="#FF0000">Adaptive Server Enterprise</font></b> - main
standard database server for OLTP and DSS
<br><font color="#6699CC">* </font><a href="http://www.sybase.com/products/databaseservers/asiq/">www.sybase.com/products/databaseservers/asiq/</a>
- <b><font color="#FF0000">Adaptive Server IQ Multiplex</font></b> - a
relational database designed to do very fast queries (ad hoc query x100
times faster than traditional RDBMSs ). This is achieved mostly because
queries are indexed and processed "by column" instead of "by row".&nbsp;
Very good database for OLAP (DSS), very good scalability to support 1000s
of users and terabytes of data IQ for the Web.
<br><font color="#6699CC">* </font><a href="http://www.sybase.com/products/anywhere/">www.sybase.com/products/anywhere/</a>
- SQL Anywhere Studio (client/development studio)
<p><font color="#6699CC">* </font><a href="http://www.isug.com/">www.isug.com/</a>
- Sybase User Group - International (ISUG) - International Sybase User's
Group home page.
<br><font color="#6699CC">* </font><a href="http://www.edbarlow.com/">www.edbarlow.com/</a>
- Ed Barlow's Sybase Stuff - A non-commercial repository of material useful
to developers and DBA's. Includes freeware such as a widely used extended
stored procedure library.
<br><font color="#6699CC">* </font><a href="http://www.tiac.net/users/sqltech/links/links.pl">www.tiac.net/users/sqltech/links/links.pl</a>
- Ed Barlow's Sybase Links - Categorized links of Sybase sites.
<p><font color="#6699CC">* </font><a href="http://www.mbay.net/~mpeppler/">www.mbay.net/~mpeppler/</a>
- Michael Peppler's Home Page - he is the author of <b>sybperl</b>, the
Sybase OpenClient extensions to Perl.
<p><font color="#6699CC">* </font><a href="http://www-es1.sybase.com/">www-es1.sybase.com/</a>
- Sybase Support - Main - Main page for support of Sybase products.
<br><font color="#6699CC">* </font><a href="http://techinfo.sybase.com">techinfo.sybase.com</a>
- Sybase Documentation - Technical Information Library - Sybase Techincal
Information
Library @sybase.com
<p><font color="#6699CC">* </font><a href="http://www.voicenet.com/~gray/sqsh.html">www.voicenet.com/~gray/sqsh.html</a>
- <b><font color="#FF0000">SQSH</font> 1.7</b> - Home page of <b>SQshelL</b>,
the alternative for the isql program supplied by Sybase. Includes downloadable
software.
<p><font color="#6699CC">* </font><a href="http://www2.dgsys.com/~dcasug/">www2.dgsys.com/~dcasug/</a>
- Sybase User Group - Washington DC - DC Area Sybase User's Group home
page.
<br><font color="#6699CC">* </font><a href="http://sybernet.sri.com/">sybernet.sri.com/</a>
- Sybernet - Stand alone CGI daemon in Unix which holds connections to
the Sybase SQL server on behalf of a stateless web client.
<br><font color="#6699CC">* </font><a href="http://sybernet.sri.com/instructions.html">sybernet.sri.com/instructions.html</a>
- A Guide for Writing Sybase Stored Procedures for the World Wide Web by
Denis D. Workman.
<p><font color="#6699CC">* </font><font color="#000000"><a href="http://www.sypron.nl/">www.sypron.nl/</a>
- Sybase Tools and Documentation by Rob Verschoor. You can order there
( <a href="http://www.sypron.nl/qr/">www.sypron.nl/qr/</a> ) a very good
book - "The Complete Sybase ASE Quick Reference Guide".</font>
<p><font color="#6699CC">* </font><a href="http://www2.dgsys.com/~dcasug/sybintro/intro.html">www2.dgsys.com/~dcasug/sybintro/intro.html</a>
- <b>Sybase Architecture - Introduction</b> - Introduction to the Sybase
architecture written by Ben Slade. Ben is a software consultant specializing
in Sybase and configuration
<br>management.
<p><font color="#6699CC">* </font><a href="http://www.sqlworkshop.com/">www.sqlworkshop.com/</a>
- The SQL Workshop - A Sybase Open Solutions CODE partner that provides
consultation to Sybase DBA's and developers.
<br><font color="#6699CC">* </font><a href="http://www.mag-sol.com/Sybase/">www.mag-sol.com/Sybase/</a>
- Sybase Contractor's Resource Page - Resources for the Sybase contractor,
including employment information.
<br><font color="#6699CC">* </font><a href="http://www.whirlycott.com/phil/dbdsybase/cms.html">www.whirlycott.com/phil/dbdsybase/cms.html</a>
- DBD Sybase on Linux Discussion Group - Online forum for DBD::Sybase on
Linux.
<br><font color="#6699CC">* </font><a href="http://www.alaska.net/~pacrim/sybase.html">www.alaska.net/~pacrim/sybase.html</a>
- Sybase Links - Pacific Rim - List of Sybase resources links maintained
by alaska.net.
<p><font color="#6699CC">* </font><a href="http://www.primenet.com/~thain/sybase/SybaseLinux.html">www.primenet.com/~thain/sybase/SybaseLinux.html</a>
- Connecting to Sybase or Microsoft SQL Server databases from Linux.
<br><font color="#6699CC">* </font><a href="http://www.acs.ncsu.edu:80/Sybase">www.acs.ncsu.edu:80/Sybase</a>
- Sybase Archive - North Carolina State University (NCSU) - Sybase information
including an F.A.Q., documentation, free downloadable tools, links.
<br><a NAME="tools"></a>
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b>Tools</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - </b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<p><font color="#6699CC">* </font>use&nbsp; <b><a href="http://www.embarcadero.com/products/dbartisan/">DBArtisan</a></b>
,  <a href="http://www.embarcadero.com/products/rapid_sql/index.php">RapidSQL</a>
from <a href="http://www.embarcadero.com/">embarcadero</a> (also <a href="http://www.embarcadero.com/products/er_studio/">ER Studio</a>).
<p><font color="#6699CC">* </font><b>isql</b> , <b>wisql</b>, <b>SQL Advantage</b>
- from Sybase.
<p><font color="#6699CC">* </font><a href="http://www.voicenet.com/~gray/sqsh.html">www.voicenet.com/~gray/sqsh.html</a>
- " <b>Sqsh</b> (pronounced skwish) is short for SQshelL (pronounced s-q-shell),
it is intended as a replacement for the venerable 'isql' program supplied
by Sybase. It came about due to years of frustration of trying to do real
work
with a program that was never meant to perform real work. Sqsh is much
more than a nice prompt, it is intended to provide much of the functionality
provided by a good shell, such as variables, redirection, pipes, back-grounding,
job control, history, command completion, and dynamic configuration. Also,
as a by-product of the design, it is remarkably easy to extend and add
functionality.
<br><a NAME="books"></a>
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b>Books</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - </b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<p><b><u><font color="#CC0000">Books:</font></u></b>
<br><font color="#CC0000">* <b>Sybase Sql Server 11 Unleashed</b> (1996)
by Ray Rankins(Editor), et al</font>
<br><font color="#CC0000">* <b>Sybase Dba Survival Guide</b> (1996) by
Jeffrey R. Garbus</font>
<p><font color="#CC0000">* <b>The Complete Sybase ASE Quick Reference Guide</b>
(2001) - order at <a href="http://www.sypron.nl/qr/">www.sypron.nl/qr/</a>
- very useful reference in small format.&nbsp; When I received 1st copy
- I immediately ordered several more. You can also download a "<b>Sybase
Replication Server Quick Reference Guide</b>" from <a href="http://www.sypron.nl/rs_qref.html">http://www.sypron.nl/rs_qref.html</a>
.</font>
<p><font color="#CC0000">* <b>The Sybase Sql Server Survival Guide</b>
(1996) by Jim Panttaja et al</font>
<br><font color="#CC0000">* <b>Sybase Dba Companion</b> (1997) by Brian
Hitchcock</font>
<br><font color="#CC0000">* <b>Transact-SQL Programming</b> (1999) by Kevin
E. Kline et al - O'Reilly (<a href="http://www.oreilly.com/catalog/wintrnssql/chapter/ch01.html">1st
chapter</a>)</font>
<br><a NAME="hints"></a>
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b>Hints</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - </b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<p>Hints
<p>Play with those commands:
<br>========================================
<br><font color="#3333FF">set rowcount 10</font>
<br><font color="#3333FF">select * from table </font><font color="#009900">--
show 10 rows of a table</font>
<p><font color="#3333FF">select * from table where 1=2</font><font color="#009900">
-- show column names (and widths separators)</font>
<br>========================================
<br>correct way to check if something is (not) null:
<br><font color="#3333FF">&nbsp;is null&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
is not null</font>
<p>remember:
<br>&nbsp;&nbsp; - you can not insert a null value into a column defined
NOT NULL unless a column has a default value bound to it
<br>&nbsp;&nbsp; - null values are not equal to each other (don't expect
them to match in where clause)
<br>&nbsp;&nbsp; - a row containing a null value is ignored in the calculation
of aggregate values (AVG, SUM, MAX)
<p>comparing fields one of which may be NULL:
<br>&nbsp;&nbsp; - change to "where exists" or "where not exists", for
example:
<br><font color="#3333FF">&nbsp; select t1.col11</font>
<br><font color="#3333FF">&nbsp; from mytab t1</font>
<br><font color="#3333FF">&nbsp; where</font>
<br><font color="#3333FF">&nbsp;&nbsp; not exists (select * from mytab
t2 where t2.parent_id = t1.id)</font>
<br><font color="#3333FF">&nbsp;&nbsp; and t1.id not in (select id from
some_other_table)</font>
<br>========================================
<br><font color="#3333FF">sp_helpdb</font> <font color="#009900">-- show
short help on all databases</font>
<br><font color="#3333FF">sp_helpdb&nbsp; some_database </font><font color="#009900">--
show help on all databases</font>
<p><font color="#3333FF">use somedatabase</font>
<br><font color="#3333FF">select db_name()</font>
<br><font color="#3333FF">select @@servername</font>
<br><font color="#3333FF">select user_name()</font>
<p><font color="#3333FF">select name from sysobjects where type='U'</font><font color="#009900">&nbsp;
-- show list of user tables ('V' - list of views, 'S' - system tables)</font>
<br><font color="#3333FF">sp_help some_table</font><font color="#009900">
-- show definitions for a table</font>
<br><font color="#3333FF">select name from sysobjects where type='P'</font><font color="#009900">&nbsp;
-- show list of stored procedures</font>
<br><font color="#3333FF">sp_helptext some_stored_procedure</font><font color="#009900">
--show text of a stored procedure</font>
<br><font color="#3333FF">select * from sysusers</font><font color="#009900">
-- shows id, group and name</font>
<br><font color="#3333FF">sp_helplogin</font><font color="#009900"> --
shows list of logins and related databases</font>
<p>on a server level there are some useful tables, for example syslogins
table in the master database:
<p><font color="#3333FF">use master</font>
<br><font color="#3333FF">go</font>
<br><font color="#3333FF">sp_help syslogins</font>
<br><font color="#3333FF">select name, fullname, dbname from syslogins</font>
<p>get a list of all user tables and stored procedures in a database:
<p><font color="#3333FF">select 'mydb', type, name from mydb..sysobjects
where type='U' order by name</font>
<br><font color="#3333FF">select 'mydb', type, name from mydb..sysobjects
where type='P' order by name</font>
<p>Use showplan to find out why the query is slow - and force indexes when
necessary:
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 BGCOLOR="#99FF99" >
<tr>
<td>showplan options - - session-level
<p>set showplan on
<br>set noexec on&nbsp; -- only command it will execute after that is <b>set
noexec off</b>
<p><b><u>real session:</u></b>
<br>set showplan on
<br>go
<br>set noexec on
<br>go
<br>select ...
<br>go
<br>exec some_store_proc
<br>go
<br>set noexec off
<br>go
<br>set showplan off
<br>go
<p><b><u>forcing a select to use an index on the table.</u></b>
<br>Let's say the table has 3 indexes listed in sp_help in order 1,2,3.
<br>If you want to use index #2, then in the 'from' part of the select
statement
<br>put the index number in the parenthesis:
<br><b><font color="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select * from
mytab t1 (2) where ...</font></b>
<p>Alternatively you can refer the index by name (starting v.11.5):
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b><font color="#3333FF">select * from
mytab (index mytab_idx) where ...</font></b>
<br>&nbsp;</td>
</tr>
</table>

<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=3 BGCOLOR="#FFFFCC" NOSAVE >
<tr>
<td>Temp-tables with hashes in reality get names tagged with session:
<p><b><font color="#3333FF">select name from tempdb..sysobjects where type
= 'U' and name like '#temp3%'</font></b>
<br>name
<br>1 #temp3_______00000810011065957</td>
</tr>
</table>

<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=3 BGCOLOR="#99FFCC" NOSAVE >
<tr NOSAVE>
<td NOSAVE><b><u>Catching new line characters:</u></b>
<br>&nbsp; select myname from mytable where charindex(char(10), myname)
!=0</td>
</tr>
</table>

<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=3 BGCOLOR="#CCFFFF" NOSAVE >
<tr NOSAVE>
<td NOSAVE><b><u>Conversion between binary(16) and varchar(32):</u></b>
<br>============================================
<br>drop table #test
<p>create table #test (cc varchar(32) null, bb binary(16) null)
<p>-----------------------------
<br>-- string to binary
<br>-----------------------------
<br>insert #test values ("873b7706de0011d59be0f05e055bbe70", null)
<p>update #test
<br>set bb = convert(binary(4), hextoint(substring(cc,&nbsp; 1, 8)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + convert(binary(4), hextoint(substring(cc,&nbsp;
9, 8)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + convert(binary(4), hextoint(substring(cc,
17, 8)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + convert(binary(4), hextoint(substring(cc,
25, 8)))
<br>from #test
<br>where cc="873b7706de0011d59be0f05e055bbe70"
<p>-----------------------------
<br>-- binary to string
<br>-----------------------------
<br>insert #test values (null,0x1234567890abcdef1234567890abcdef)
<p>update #test
<br>set cc = lower(
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inttohex(convert(binary,
substring(bb,&nbsp; 1, 4)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + inttohex(convert(binary,
substring(bb,&nbsp; 5, 4)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + inttohex(convert(binary,
substring(bb,&nbsp; 9, 4)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + inttohex(convert(binary,
substring(bb, 13, 4)))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )
<br>from #test
<br>where bb=0x1234567890abcdef1234567890abcdef
<br>============================================
<p>select * from #test
<p>============================================</td>
</tr>
</table>

<p><a NAME="bcp"></a>
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b>bcp utility</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - </b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<p><b>bcp</b> - bulk copy utility
<p>From unix prompt:
<br><b><u>output a table in tab-separated text file:</u></b>
<br><font color="#3333FF">&nbsp;&nbsp; bcp mydb..mytable <b>out</b> somefile.txt
-Ssomeserver -Usomeuser -Psomepassword -c</font>
<br><b><u>read tab-separated text file into a table:</u></b>
<br>&nbsp; Note1: you may need to have an index on destination table.
<br>&nbsp; Note2: you may need to update statistics on destination table
afterwards:
<br><font color="#3333FF">&nbsp;&nbsp;&nbsp; bcp mydb..mytable <b>in</b>
somefile -Ssomeserver -Usomeuser -Psomepassword -c</font>
<p>To change field or row terminators use -t or -r options, for example
if you want to separate the columns with something like this:
<br>&nbsp; '&lt;&amp;+f>'
<br>Then use the following command:
<br><font color="#3333FF">&nbsp; bcp tempdb..lev_rep1&nbsp; out&nbsp; resultfile.txt
-Ssomeserver -Usomeuser -Psomepassword -c -t '&lt;&amp;+f>'</font>
<p>Note: bcp does not fire any trigger that exists on the target table.
<p><b><u></u></b> Note: If the table has indexes and/or triggers - then Sybase uses &quot;slow&quot; bcp which  logs data inserts in the transaction log. These logged inserts can cause the transaction log to become very large.
<p><b><u>Example of a script copying tables from db1 to db2:</u></b>
<table BORDER=0 CELLSPACING=0 BGCOLOR="#99FF99" >
<tr>
<td NOWRAP>#!/bin/sh -v
<br>bcp dbase..tab1&nbsp; <b>out</b>&nbsp; tab1.dat -S <b>DBSERV1</b> -U
someuser -P somepasswd -c > /dev/null
<br>bcp dbase..tab2&nbsp; <b>out</b>&nbsp; tab2.dat -S <b>DBSERV1</b> -U
someuser -P somepasswd -c > /dev/null
<p>isql -S DBSERV2 -U someuser -P somepasswd -w250 &lt;&lt;EOF
<br>use dbase
<br>go
<br>delete tab1
<br>go
<br>delete tab2
<br>go
<br>EOF
<p>bcp dbase..tab1&nbsp; <b>in</b>&nbsp; tab1.dat -S <b>DBSERV2</b> -U
someuser -P somepasswd -c > /dev/null
<br>bcp dbase..tab2&nbsp; <b>in</b>&nbsp; tab2.dat -S <b>DBSERV2</b> -U
someuser -P somepasswd -c > /dev/null
<p>isql -S DBSERV2 -U someuser -P somepasswd -w250 &lt;&lt;EOF
<br>use dbase
<br>go
<br><font color="#000000">update statistics tab1</font>
<br><font color="#000000">go</font>
<br><font color="#000000">update statistics tab2</font>
<br>go
<br>EOF</td>
</tr>
</table>

<p>Even better example: script p2d. Note that it takes care of updating
statistics
<br>and of recompiling stored procedures related to those tables:
<table BORDER=0 CELLSPACING=0 BGCOLOR="#99FF99" >
<tr>
<td NOWRAP>#!/usr/local/bin/perl
<br>#
<br># p2d - simple script to copy table data&nbsp;
<br># (from production to development)
<p>use strict;
<p>my $DEV&nbsp; = '-S DEV&nbsp; -U someuser -P somepass';
<br>my $PROD = '-S PROD -U someuser -P somepass';
<br>my $db = 'somedatabase';
<p>my @tabs;
<br>if(@ARGV){
<br>&nbsp; @tabs = @ARGV;
<br>} else {
<br>&nbsp; print "p2d - simple script to copy table data from production
to development\n";
<br>&nbsp; print "USAGE: p2d tab1 tab2 ...\n";
<br>&nbsp; exit(0);
<br>}&nbsp;
<p>my $counter=0;
<p>for my $tab (@tabs) {
<p>&nbsp; chomp($tab);
<br>&nbsp; $tab =~ s/(^\s+|\s+$)//g;
<br>&nbsp; next if ! $tab;
<br>&nbsp; $counter++;
<br>&nbsp; print"\nTABLE No $counter - $tab\n";
<p>&nbsp; my ($command,$out);
<br>&nbsp; $command = "<b><font color="#CC0000">bcp</font></b> $db..$tab
out $tab.dat $PROD -c";
<br>&nbsp; print "$command\n"; $out = <b>qx</b>($command);
<p>&nbsp; $command = "<b><font color="#CC0000">isql</font></b> $DEV -w250
&lt;&lt;EOF\nuse $db\ngo\n";
<br>&nbsp; $command .= "<b><font color="#CC0000">truncate</font></b> table
$tab\ngo\n";
<br>&nbsp; $command .= "\nEOF\n";
<br>&nbsp; print "truncate table $tab on DEV\n"; $out = <b>qx</b>($command);
<p>&nbsp; $command = "<b><font color="#CC0000">bcp</font></b> $db..$tab
in $tab.dat $DEV -c";
<br>&nbsp; print "$command\n"; $out = <b>qx</b>($command);
<p>&nbsp; $command = "<b><font color="#CC0000">rm</font></b> -f $tab.dat";
<br>&nbsp; print "$command\n"; $out = <b>qx</b>($command);
<p>&nbsp; $command = "isql $DEV -w250 &lt;&lt;EOF\nuse $db\ngo\n";
<br>&nbsp; $command .= "<b><font color="#CC0000">update statistics</font></b>
$tab\ngo\nexec <b><font color="#CC0000">sp_recompile</font></b> $tab\ngo";
<br>&nbsp; $command .= "\nEOF\n";
<br>&nbsp; print "update statistics and sp_recompile $tab on DEV\n"; $out
= <b>qx</b>($command);
<p>}
<p>print "FINISHED\n";</td>
</tr>
</table>

<p><b><u>How to get tab-separated data into the database from perl script:</u></b>
<table BORDER=0 CELLSPACING=0 BGCOLOR="#99FF99" >
<tr>
<td>First, create a text file <font color="#3333FF">$inputFileName </font>with
tab-separated data: rows of data correspond to rows of the table
<br>Just data - no headers, no comments
<br><b><font color="#CC0000">----- delete previous table</font></b>
<br>$dbh->dbcmd("<font color="#3333FF">truncate table $tableName</font>");
<br><b><font color="#CC0000">----- bcp in new data</font></b>
<br>my $bcpcmd = "<font color="#3333FF">bcp oe..$tableName </font><font color="#CC0000">in</font><font color="#3333FF">
$inputFileName</font>";
<br>$bcpcmd .= "<font color="#3333FF"> -Sserver_name -Uuser_name -Ppasswd
-c</font>";
<br>if ($diagMsg == 0) { $bcpcmd .= "<font color="#3333FF"> > /dev/null</font>";
}
<br><b><font color="#000099">$rc = system($bcpcmd);</font></b>
<br>&nbsp;if ($rc != 0) {
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $rc /= 256;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $errMsg = "bcp operation
for table \'$tableName\' failed (bcp retcod = $rc).";
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $False;
<br>&nbsp;}
<br><b><font color="#CC0000">----- update indexes</font></b>
<br>$dbh->dbcmd("<font color="#3333FF">update statistics $tableName</font>");</td>
</tr>
</table>
<a NAME="results_into_excel"></a>
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#C4ECFF" >
<tr>
<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>

<td ALIGN=LEFT><b>getting large result set into excel</b></td>

<td ALIGN=RIGHT VALIGN=BOTTOM><b><a href="index.html">home</a> - <a href="#top">top
of the page</a> - <a href="mailto:Lev.Selector@gmail.com">email</a></b></td>

<td ALIGN=LEFT WIDTH="1%"><spacer type=block width=1 height=1></td>
</tr>
</table>

<p>The idea is to select the results into a named table in a tempdb database.
<br>Then bcp it in a text file (extension .txt)
<br>Then open it by Excel - it will automaticall ask you if you want to
treat is as delimited
<br>Then save it as excel file
<p><font color="#3333FF">drop table tempdb..mytable</font>
<br><font color="#3333FF">select something</font>
<br><font color="#3333FF">into tempdb..mytable</font>
<br><font color="#3333FF">from some_tables</font>
<br><font color="#3333FF">where some_joins_and_restrictions</font>
<p>---------------------------------------------------
<br>&nbsp;
</body>
</html>
